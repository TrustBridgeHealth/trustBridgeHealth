version: 1
env:
  DATABASE_URL: ${DATABASE_URL}
frontend:
  phases:
    preBuild:
      commands:
        - npm install -g pnpm
        - pnpm install --frozen-lockfile
    build:
      commands:
        - pnpm run build
        - echo "Env var test: $DATABASE_URL"
        - npx prisma generate
        # If you have a build step, e.g. TypeScript:
        # - pnpm build
        # If it's just a plain Node backend, you can skip or keep it simple:
        - echo "Build step complete"
  artifacts:
    # If this is PURE backend, there may be no frontend artifacts.
    # You can leave something minimal or adjust if you actually have a frontend.
    baseDirectory: .next
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
      - .pnpm-store/**/*
backend:
  phases:
    build:
      commands:
        - pnpm run build
        - echo "Env var test: $DATABASE_URL"
        - npx prisma generate
        # If you have a build step, e.g. TypeScript:
        # - pnpm build
        # If it's just a plain Node backend, you can skip or keep it simple:
        - echo "Build step complete"

